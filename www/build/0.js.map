{"version":3,"sources":["../../src/pages/settings/settings.module.ts","../../src/pages/settings/settings.ts","../../src/components/progress-bar/progress-bar.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport {IonicPageModule} from 'ionic-angular';\r\nimport { SettingsPage } from './settings';\r\nimport {ProgressBarComponent} from \"../../components/progress-bar/progress-bar\";\r\n\r\n@NgModule({\r\n  declarations: [\r\n    SettingsPage,\r\n    ProgressBarComponent\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(SettingsPage),\r\n  ],\r\n  exports: [\r\n    SettingsPage\r\n  ]\r\n})\r\nexport class SettingsPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/settings/settings.module.ts","import { Component } from '@angular/core';\r\nimport {DataService} from \"../../providers/data-service/data-service\";\r\nimport {IonicPage, Platform} from \"ionic-angular\";\r\n\r\nimport { FileTransfer, FileTransferObject } from '@ionic-native/file-transfer';\r\nimport { File } from '@ionic-native/file';\r\nimport {AudioProvider} from \"ionic-audio\";\r\n\r\n@IonicPage()\r\n\r\n@Component({\r\n  selector: 'page-settings',\r\n  templateUrl: 'settings.html',\r\n})\r\nexport class SettingsPage {\r\n\r\n  lang:string;\r\n  counter:number = 0;\r\n  count:number = 0;\r\n  percentage:number = 0;\r\n\r\n\r\n  constructor(\r\n    private audio:AudioProvider,\r\n    private dataService:DataService,\r\n    private platform:Platform,\r\n    private transfer: FileTransfer, private file: File\r\n  ) {\r\n    this.lang = this.dataService.currLang;\r\n  }\r\n\r\n  ionViewDidLoad(){\r\n\r\n    this.count = this.dataService.modulesData[0].module.series.reduce(function (prev, next) {\r\n      return prev + next.chapters.length - 6;\r\n    },0)\r\n  }\r\n\r\n  onChangeLang(){\r\n    this.dataService.setLanguage(this.lang);\r\n    this.audio.current = null;\r\n    //this.audio.tracks = []\r\n    console.log(\"Tracks in Provider\",this.audio.tracks)\r\n\r\n  }\r\n\r\n  async getChapter(chapter:any,serie:string){\r\n    const fileTransfer: FileTransferObject = this.transfer.create();\r\n    if(chapter.media){\r\n\r\n      const pdfTitle = chapter.media.pdf.split('/').pop();\r\n      const mp3Title = chapter.media.mp3.split('/').pop();\r\n\r\n      let pdf:any;\r\n      let mp3:any;\r\n\r\n      if(this.platform.is('ios')){\r\n        pdf = await fileTransfer.download(chapter.media.pdf, this.file.dataDirectory + '/'+this.lang+'/' + pdfTitle);\r\n        mp3 = await fileTransfer.download(chapter.media.mp3, this.file.dataDirectory + '/'+this.lang+'/' + mp3Title);\r\n      }\r\n      if(this.platform.is('android')){\r\n        pdf = await fileTransfer.download(chapter.media.pdf, this.file.externalDataDirectory + '/'+this.lang+'/' + pdfTitle);\r\n        mp3 = await fileTransfer.download(chapter.media.mp3, this.file.externalDataDirectory + '/'+this.lang+'/' + mp3Title);\r\n      }\r\n\r\n\r\n\r\n      this.counter++;\r\n      this.percentage = Math.ceil((this.counter/this.count)*100);\r\n      console.log('download complete: ' + pdf.toURL());\r\n      console.log('download complete: ' + mp3.toURL());\r\n    }\r\n  }\r\n\r\n  async getChapters(chapters:any[],serie:string){\r\n    for(let i=0;i<chapters.length;i++){\r\n      try {\r\n        await this.getChapter(chapters[i],serie)\r\n      }\r\n      catch (err){\r\n        console.log(\"ERROR:\",err)\r\n      }\r\n    }\r\n  }\r\n\r\n  async getSerie(serie){\r\n    const chapters = serie.chapters;\r\n    const serieTitle = serie.title;\r\n    this.getChapters(chapters,serieTitle)\r\n  }\r\n\r\n  async getSeries(series){\r\n    for(let i=0;i<series.length;i++){\r\n      try {\r\n\r\n        await this.getSerie(series[i])\r\n      }\r\n      catch (err){\r\n        console.log(\"ERROR:\",err)\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  async download(){\r\n\r\n    this.counter = 0;\r\n    this.percentage = 0;\r\n    const series = this.dataService.modulesData.filter(module=>module.lang === this.dataService.currLang)[0].module.series;\r\n    await this.getSeries(series)\r\n    this.dataService.loadedModules[this.dataService.currLang] = false;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/settings/settings.ts","import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'progress-bar',\r\n  templateUrl: 'progress-bar.html'\r\n})\r\nexport class ProgressBarComponent {\r\n\r\n  @Input('progress') progress;\r\n\r\n  constructor() {\r\n\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/progress-bar/progress-bar.ts"],"sourceRoot":""}